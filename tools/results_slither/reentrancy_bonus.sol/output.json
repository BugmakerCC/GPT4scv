[{"check": "arbitrary-send", "impact": "High", "confidence": "Medium", "description": "Reentrancy_bonus.withdrawReward (/sb/reentrancy_bonus.sol#16-21) sends eth to arbitrary user\n\tDangerous calls:\n\t- (success) = recipient.call.value(amountToWithdraw)() (/sb/reentrancy_bonus.sol#19)\n", "elements": [{"type": "function", "name": "withdrawReward", "source_mapping": {"start": 372, "length": 246, "filename": "/sb/reentrancy_bonus.sol", "lines": [16, 17, 18, 19, 20, 21]}, "contract": {"type": "contract", "name": "Reentrancy_bonus", "source_mapping": {"start": 168, "length": 865, "filename": "/sb/reentrancy_bonus.sol", "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]}}}, {"type": "expression", "expression": "(success) = recipient.call.value(amountToWithdraw)()", "source_mapping": {"start": 524, "length": 61, "filename": "/sb/reentrancy_bonus.sol", "lines": [19]}}]}, {"check": "reentrancy-eth", "impact": "High", "confidence": "Medium", "description": "Reentrancy in Reentrancy_bonus.getFirstWithdrawalBonus (/sb/reentrancy_bonus.sol#23-30):\n\tExternal calls:\n\t- withdrawReward(recipient) (/sb/reentrancy_bonus.sol#28)\n\tState variables written after the call(s):\n\t- claimedBonus (/sb/reentrancy_bonus.sol#29)\n", "elements": [{"type": "function", "name": "getFirstWithdrawalBonus", "source_mapping": {"start": 624, "length": 407, "filename": "/sb/reentrancy_bonus.sol", "lines": [23, 24, 25, 26, 27, 28, 29, 30]}, "contract": {"type": "contract", "name": "Reentrancy_bonus", "source_mapping": {"start": 168, "length": 865, "filename": "/sb/reentrancy_bonus.sol", "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]}}}, {"type": "external_calls", "expression": "withdrawReward(recipient)", "source_mapping": {"start": 875, "length": 25, "filename": "/sb/reentrancy_bonus.sol", "lines": [28]}}, {"type": "variables_written", "name": "claimedBonus", "expression": "claimedBonus[recipient] = true", "source_mapping": {"start": 994, "length": 30, "filename": "/sb/reentrancy_bonus.sol", "lines": [29]}}]}, {"check": "external-function", "impact": "Informational", "confidence": "High", "description": "Reentrancy_bonus.getFirstWithdrawalBonus (/sb/reentrancy_bonus.sol#23-30) should be declared external\n", "elements": [{"type": "function", "name": "getFirstWithdrawalBonus", "source_mapping": {"start": 624, "length": 407, "filename": "/sb/reentrancy_bonus.sol", "lines": [23, 24, 25, 26, 27, 28, 29, 30]}, "contract": {"type": "contract", "name": "Reentrancy_bonus", "source_mapping": {"start": 168, "length": 865, "filename": "/sb/reentrancy_bonus.sol", "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]}}}]}, {"check": "solc-version", "impact": "Informational", "confidence": "High", "description": "Detected issues with version pragma in /sb/reentrancy_bonus.sol:\n\t- pragma solidity^0.4.0 (/sb/reentrancy_bonus.sol#7): it allows old versions\n", "elements": [{"type": "expression", "expression": "^0.4.0", "source_mapping": {"start": 143, "length": 23, "filename": "/sb/reentrancy_bonus.sol", "lines": [7]}}]}, {"check": "low-level-calls", "impact": "Informational", "confidence": "High", "description": "Low level call in Reentrancy_bonus.withdrawReward (/sb/reentrancy_bonus.sol#16-21):\n\t-(success) = recipient.call.value(amountToWithdraw)() /sb/reentrancy_bonus.sol#19\n", "elements": [{"type": "function", "name": "withdrawReward", "source_mapping": {"start": 372, "length": 246, "filename": "/sb/reentrancy_bonus.sol", "lines": [16, 17, 18, 19, 20, 21]}, "contract": {"type": "contract", "name": "Reentrancy_bonus", "source_mapping": {"start": 168, "length": 865, "filename": "/sb/reentrancy_bonus.sol", "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]}}}, {"type": "expression", "expression": "(success) = recipient.call.value(amountToWithdraw)()", "source_mapping": {"start": 524, "length": 61, "filename": "/sb/reentrancy_bonus.sol", "lines": [19]}}]}, {"check": "naming-convention", "impact": "Informational", "confidence": "High", "description": "Contract 'Reentrancy_bonus' (/sb/reentrancy_bonus.sol#9-31) is not in CapWords\n", "elements": [{"target": "contract", "convention": "CapWords", "name": "Reentrancy_bonus", "source_mapping": {"start": 168, "length": 865, "filename": "/sb/reentrancy_bonus.sol", "lines": [9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31]}}]}, {"check": "unused-state", "impact": "Informational", "confidence": "High", "description": "Reentrancy_bonus.userBalances (/sb/reentrancy_bonus.sol#12) is never used in Reentrancy_bonus\n", "elements": [{"type": "variable", "name": "userBalances", "source_mapping": {"start": 216, "length": 46, "filename": "/sb/reentrancy_bonus.sol", "lines": [12]}}]}]